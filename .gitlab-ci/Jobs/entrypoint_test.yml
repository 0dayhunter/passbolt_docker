entrypoint-tests:
  stage: test
  image: registry.gitlab.com/passbolt/passbolt-ci-docker-images/debian-bullseye-11-slim:latest
  before_script:
    - apt update && apt install curl git -y
    - curl -fsSL https://git.io/shellspec | sh -s -- --yes
  script:
    - /root/.local/bin/shellspec -c debian/entrypoint -s /bin/bash -f d
  rules:
  - if: '$CI_PIPELINE_SOURCE == "schedule" || $CI_COMMIT_BRANCH == "develop" || $CI_COMMIT_MESSAGE =~ /test-image/ || $CI_COMMIT_BRANCH == "master"
    when: on_success
